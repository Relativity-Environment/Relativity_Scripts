#NoEnv  ; Recommended for performance and compatibility with future AutoHotkey releases.
;#Warn   ; Enable warnings to assist with detecting common errors.
#WinActivateForce

SendMode Input
SetWorkingDir %A_ScriptDir%
SetKeyDelay, 50

;Handle onionshare-2.2-setup.exe
title = OnionShare Setup: Installation Folder
Run, onionshare-2.2-setup.exe


WinWait, %title%,,5000
IfWinExist %title%
{
  WinActivate, %title%  
  
  Sleep, 500
  BlockInput On

  Sleep, 500
  ControlClick, &Install
  

  Sleep, 10000
  ControlClick, &Close
   
  
  BlockInput Off
}

Exit,